@page "/SamplePages/CustomerEdit/{CustomerID:int}"
<PageTitle>Customer Edit</PageTitle>

@if(CustomerID == 0)
{
    <MudText Typo="Typo.h3">New Customer</MudText>
}
else
{
    <MudText Typo="Typo.h3">Edit Customer: @customer.FirstName @customer.LastName </MudText>
}
@if (hasError)
{
    <MudAlert
        Elevation="2"
        Severity="Severity.Error"
        Dense="true">
        <MudText
            Typo="Typo.h6">
            @errorMessage
        </MudText>
@foreach (var error in errorDetails)
        {
            <MudText Typo="Typo.body2">@error</MudText>
        }
    </MudAlert>
}

@if (hasFeedback)
{
    <MudAlert Elevation="2" Severity="Severity.Info" Dense="true">
        <MudText Typo="Typo.body2">@feedbackMessage</MudText>
    </MudAlert>
}

<MudForm @ref="customerForm" @bind-IsValid="isFormValid" @bind-IsTouched="hasDataChanged">
    <MudGrid>
        <MudItem xs="6">
            <MudTextField
                Label="First Name"
                @bind-Value="customer.FirstName"
                Variant="Variant.Outlined"
                Required="true"
                RequiredError="First Name is Required"
                MaxLength="20"
                Immediate="true"
            />
            <MudTextField
                Label="Last Name"
                @bind-Value="customer.LastName"
                Variant="Variant.Outlined"
                Required="true"
                RequiredError="Last Name is Required"
                MaxLength="50"
                Immediate="true"
            />
            <MudTextField
                Label="Address 1"
                @bind-Value="customer.Address1"
                Variant="Variant.Outlined"
                Required="true"
                RequiredError="Address 1 is Required"
                MaxLength="50"
                Immediate="true"
            />
            <MudTextField
                Label="Address 2"
                @bind-Value="customer.Address2"
                Variant="Variant.Outlined"
                MaxLength="50"
                Immediate="true"
            />
            <MudTextField
                @bind-Value="customer.City"
                Variant="Variant.Outlined"
                Required="true"
                RequiredError="City is required."
                MaxLength="50"
                Immediate="true"
            />
            <MudSelect
                @bind-Value="customer.ProvStateID"
                Variant="Variant.Outlined"
                Label="Province"
                Required="true"
                RequiredError="You must select a province">
                @foreach (var item in provinces)
                {
                    <MudSelectItem T="int" Value="@item.LookupID">@item.Name</MudSelectItem>
                }
            </MudSelect>
        </MudItem>
        <MudItem xs="6">
            <MudSelect
                @bind-Value="customer.CountryID"
                Variant="Variant.Outlined"
                Label="Country"
                Required="true"
                RequiredError="You must select a Country">
                @foreach (var item in countries)
                {
                    <MudSelectItem T="int" Value="@item.LookupID">@item.Name</MudSelectItem>
                }
            </MudSelect>
            <MudTextField
                Label="Postal Code"
                @bind-Value="customer.PostalCode"
                Variant="Variant.Outlined"
                Required="true"
                RequiredError="Postal code is required"
                MaxLength="20"
                Immediate="true"
            />
            <MudTextField
                Label="Phone Number"
                @bind-Value="customer.Phone"
                Variant="Variant.Outlined"
                Required="true"
                RequiredError="Phone Number is required"
                MaxLength="20"
                Format="###-###-####"
                Immediate="true"
            />
            <MudTextField
                  Label="Email"
                  @bind-Value="customer.Email"
                  Variant="Variant.Outlined"
                  Required="true"
                  RequiredError="Email is required"
                  MaxLength="250"
                  InputType="InputType.Email"
                  Immediate="true"
              />
            <MudSelect
                @bind-Value="customer.StatusID"
                Variant="Variant.Outlined"
                Label="Customer Status"
                Required="true"
                RequiredError="You must select a customer status."
            >
                @foreach (var item in statusLookup)
                {
                    <MudSelectItem T="int" Value="@item.LookupID">@item.Name</MudSelectItem>
                }
            </MudSelect>
            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="Save" Disabled="@(!isFormValid || !hasDataChanged)">Save</MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Error" OnClick="Cancel" Class="ml-4">@closeButtonText</MudButton>
            </MudItem>
    </MudGrid>
</MudForm>